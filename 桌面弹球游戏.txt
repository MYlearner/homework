package javaapplication3;
import java.awt.event.*;
import java.util.*;
import java.awt.*;
import javax.swing.Timer;

public class Ball {
	private final int t_w = 300;
	private final int t_h = 400;
	private final int sizey = 340;
	private final int b_h = 20;
	private final int b_w = 60;
	private final int BALL_SIZE = 16;
	private Frame f = new Frame("网球游戏");
	Random rand = new Random();
	private int ySpeed = 12;
	private double sxy = rand.nextDouble() - 0.5;
	private int xSpeed = (int)(ySpeed * sxy * 2);
	private int sizebx = rand.nextInt(200) + 20;
	private int sizeby = rand.nextInt(10) + 20;
	
	private int sizex = rand.nextInt(200);
	private Mysee tableArea = new Mysee();
	Timer timer;
	
	private boolean isLose = false;
	
	public void init() {
        f.addWindowListener(new WindowAdapter() {
            public void windowClosing(WindowEvent e) {
                System.exit(0);
            }
        });
		tableArea.setPreferredSize(new Dimension(t_w, t_h));
		f.add(tableArea);
		
		KeyAdapter keyProcessor = new KeyAdapter() {
			public void keyPressed (KeyEvent mkey) {
				
				if (mkey.getKeyCode() == KeyEvent.VK_LEFT) {
					if (sizex > 0) {
						sizex -= 10;
					}
				}
				if (mkey.getKeyCode() == KeyEvent.VK_RIGHT) {
					if (sizex < t_w - b_w) {
						sizex += 10;
					}
				}
			}
		};
		f.addKeyListener(keyProcessor);
		tableArea.addKeyListener(keyProcessor);
		ActionListener taskPerformer = evt ->{
			if(sizebx <= 0 || sizebx >= t_w - BALL_SIZE) {
				xSpeed = -xSpeed;
			}
			if(sizeby >= sizey - BALL_SIZE && (sizebx < sizex || sizebx > sizex + b_w)) {
				timer.stop();
				isLose = true;
				tableArea.repaint();
			}
			else if(sizeby <= 0 ||( sizeby > sizey - BALL_SIZE && sizebx > sizex && sizebx <= sizex + b_w) ){
				ySpeed = -ySpeed;
			}
			//小球坐标增加
			sizeby += ySpeed;
			sizebx += xSpeed;
			tableArea.repaint();
		};
		timer = new Timer(100, taskPerformer);
		timer.start();
		f.pack();
		f.setVisible(true);
		
	}
	
	public static void main(String[] args) {
		new PinBall().init();
	}
	
	class Mysee extends Canvas{
	    private static final long serialVersionUID = 1L;
	
		public void paint(Graphics game) {
			//如果游戏已经结束
			if(isLose) {
				game.setColor(new Color(255, 0, 0));
				game.setFont(new Font("Times", Font.BOLD, 35));
				game.drawString("游戏已结束", 40, 150);
			}
			//如果游戏还没结束
			else {
				game.setColor(new Color(50, 240, 80));
				game.fillOval(sizebx, sizeby, BALL_SIZE, BALL_SIZE);
				game.setColor(new Color(200, 80, 200));
				game.fillRect(sizex, sizey, b_w, b_h);
			}
		}
	}
}